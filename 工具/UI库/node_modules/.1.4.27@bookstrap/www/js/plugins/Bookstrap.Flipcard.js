/*global bookstrap: false */
define([
  'underscore'
  ],
  function(_) {
    var FLIPCARD_SELECTOR = '.book-flipcard', // flipcard container
        // inside the flipcard container we need two containers holding front and back side:
        // class="book-flipcard-front"
        // class="book-flipcard-back"
        FLIPCARD_TURN_SELECTOR = '.book-flipcard-turn', // flipcard turn element(s), should be inside front/back side containers
        FLIPCARD_FLIPPED_CLASS = 'book-flipped'; // currently visible side

    var FlipcardPlugin = function() {
      bookstrap.on('pageload', _.bind(this.onPageLoad, this));
    };

    FlipcardPlugin.prototype.onPageLoad = function(page) {
      $(FLIPCARD_SELECTOR).on('click', FLIPCARD_TURN_SELECTOR, function(e){
        $(this).closest(FLIPCARD_SELECTOR).toggleClass(FLIPCARD_FLIPPED_CLASS);
        return false;
      });
    };

    return FlipcardPlugin;
});