var path = require('path');

module.exports = function(grunt) {
	var moduleName = grunt.option('module') || 'main';
	
	var initConfig = {
		moduleName: moduleName,
		distJSFilename: moduleName.replace('main', 'bookstrap')
	};

	// load-grunt-config does the following:
	// - load all grunt tasks matching the `grunt-*` pattern in devDependencies
	// - load configs in the grunt/config directory
	// - exposes package.json like this: <%= package.name %>
	// - register tasks from grunt/config/aliases.js
	require('load-grunt-config')(grunt, {
		configPath: path.resolve('grunt/config'),
		config: initConfig
	});

	// load custom tasks
	grunt.loadTasks(path.resolve('grunt/tasks'));

	// log watch events
	grunt.event.on('watch', function(action, filepath, target) {
		grunt.log.writeln(target + ': ' + filepath + ' has ' + action);
	});
};