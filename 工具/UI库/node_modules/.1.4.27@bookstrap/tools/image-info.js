var system = require('system'),
    webpage = require('webpage');

if (system.args.length === 1) {
    console.log('Usage: ' + system.args[0] + ' <some URL>');
    phantom.exit();
}

var page = webpage.create(),
    url = system.args[1];

page.viewportSize = { width: 1024, height: 768 };

page.open(url, function (status) {
  if (status !== 'success') {
    console.warn('Could not load page ' + url);
    phantom.exit(1);
  }

  page.includeJs('js/lib/zepto.js', function() {
    var images = page.evaluate(function() {
      var imgs = [];
      $('img').each(function() {
        imgs.push({
          src: $(this).attr('src'),
          width: $(this).width(),
          height: $(this).height()
        });
      });
      return imgs;
    });

    console.log(JSON.stringify(images));
    phantom.exit(0);

  });

});